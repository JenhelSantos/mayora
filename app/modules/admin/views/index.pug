doctype html
html(lang='en')
	head
		meta(charset='utf-8')
		link(rel='icon', type='image/png', href='/logo/logo-black.png')
		link(rel='apple-touch-icon', sizes='76x76', href='/logo/logo-black.png')
		meta(http-equiv='X-UA-Compatible', content='IE=edge,chrome=1')
		title Admin - Verify Landlords
		// Bootstrap core CSS
		link(href='/paperDashboard/css/bootstrap.min.css', rel='stylesheet')
		// Paper Dashboard core CSS
		link(href='/paperDashboard/css/paper-dashboard23cd.css?v=1.2.1', rel='stylesheet')
		// CSS for Demo Purpose, don't include it in your project
		link(href='/paperDashboard/css/demo.css', rel='stylesheet')
		// Fonts and icons
		link(href='/paper/font-awesome-4.7.0/css/font-awesome.min.css', rel='stylesheet')
		link(href='/paperDashboard/fonts/cssbba8.css?family=Muli:400,300', rel='stylesheet', type='text/css')
		link(href='/paperDashboard/css/themify-icons.css', rel='stylesheet')
	body
		.wrapper
			.sidebar(data-background-color='brown', data-active-color='mayora')
				.logo
					a.simple-text.logo-mini(href='/landlord')
						img(src='/logo/logo-white.png' style='width:35px; height:35px')
					a.simple-text.logo-normal(href='/landlord')
						img(src='/logo/logo-white.png' style='width:35px; height:35px')
						| ayora
				.sidebar-wrapper
					.user
						.info
							.photo
								img(src='/paper/img/flume.jpg')
							a.collapsed(data-toggle='collapse', href='#collapseExample')
								span
									| Mayora Admin
									b.caret
							.clearfix
							#collapseExample.collapse
								ul.nav
									li
										a(href='/logout')
											span.sidebar-mini L
											span.sidebar-normal Logout
					ul.nav
						li.active
							a(data-toggle='collapse', href='#componentsExamples')
								i.ti-package
								p
									| Verify
									b.caret
							#componentsExamples.collapse.in
								ul.nav
									li.active
										a(href='/landlord/rooms')
											span.sidebar-mini L
											span.sidebar-normal Landlords
									li
										a(href='/landlord/tenants')
											span.sidebar-mini T
											span.sidebar-normal Tenants
						//li
							a(data-toggle='collapse', href='#formsExamples')
								i.ti-clipboard
								p
									| Transactions
									b.caret
							#formsExamples.collapse
								ul.nav
									li
										a(href='/landlord/payments')
											span.sidebar-mini P
											span.sidebar-normal Payments
									li
										a(href='/landlord/deposits')
											span.sidebar-mini D
											span.sidebar-normal Deposits
						//li
							a(href='/landlord/utilities')
								i.ti-panel
								p
									| Utilities
			.main-panel
				nav.navbar.navbar-default
					.container-fluid
						.navbar-minimize
							button#minimizeSidebar.btn.btn-fill.btn-icon
								i.ti-arrow-left
						.navbar-header
							button.navbar-toggle(type='button')
								span.sr-only Toggle navigation
								span.icon-bar.bar1
								span.icon-bar.bar2
								span.icon-bar.bar3
							a.navbar-brand
								| Verify Landlords
						.collapse.navbar-collapse
							ul.nav.navbar-nav.navbar-right
								li.dropdown
									a.dropdown-toggle.btn-rotate(href='#notifications', data-toggle='dropdown')
										i.ti-bell
										span.notification 5
										p.hidden-md.hidden-lg
											| Notifications
											b.caret
									ul.dropdown-menu
										li
											a(href='#not1') Notification 1
										li
											a(href='#not2') Notification 2
										li
											a(href='#not3') Notification 3
										li
											a(href='#not4') Notification 4
										li
											a(href='#another') Another notification
				.content
					.container-fluid
						.row
							.col-md-12
								h4.title Pending Landlords
								p.category Here is the List of all of the pending landlords in Mayora
								br
								.card
									.card-content
										.toolbar
											// Here you can write extra buttons/actions for the toolbar
										.fresh-datatables
											table#datatables.table.table-striped.table-no-bordered.table-hover(cellspacing='0', width='100%', style='width:100%')
												thead
													tr
														th Landlord ID
														th Valid ID
														th BIR Permit
														th Land Title
														th Payment Slip
														th.disabled-sorting Actions
												tfoot
													tr
														th Landlord ID
														th Valid ID
														th BIR Permit
														th Land Title
														th Payment Slip
														th Actions
												tbody
													each result in resultsForPug
														tr
															td #{result.strLandlordID}
															td
																button.btn.btn-info.btn-rounded.viewId(type='button' value=`${result.strLandlordID}`) View
															td
																button.btn.btn-info.btn-rounded.viewBir(type='button' value=`${result.strLandlordID}`) View
															td
																button.btn.btn-info.btn-rounded.viewLandTitle(type='button' value=`${result.strLandlordID}`) View
															td
																button.btn.btn-info.btn-rounded.viewPayment(type='button' value=`${result.strLandlordID}`) View
															td
																button.btn.btn-simple.btn-success.btn-icon.acceptLandlord(type='button' disabled id=`accept${result.strLandlordID}` value=`${result.strLandlordID}`)
																	i.ti-check
																button.btn.btn-simple.btn-danger.btn-icon.rejectLandlord(type='button' id=`reject${result.strLandlordID}` value=`${result.strLandlordID}`)
																	i.ti-close
								// end card
							// end col-md-12
						// end row
				footer.footer
					.container-fluid
						nav.pull-left
							ul
								li
									a(href='/index/ourteam')
										| Our Team
								li
									a(href='/index/abouttheapp')
										| About the App
						.copyright.pull-right
							| © 
							script.
								document.write(new Date().getFullYear())
							| , made with 
							i.fa.fa-heart.heart
							|  by 
							a Mayora Team
		//MODALS
		#idModal.modal.fade(tabindex='-1', role='dialog', aria-hidden='false')
			.modal-dialog.modal-register
				.modal-content
					.modal-header.no-border-header.text-center
						button.close(type='button', data-dismiss='modal', aria-label='Close')
							span(aria-hidden='true') ×
						h6.text-muted ID
						h3.modal-title.text-center Proof of Identity
					.modal-body
						.row
							.col-md-12#idModalBody
		#birModal.modal.fade(tabindex='-1', role='dialog', aria-hidden='false')
			.modal-dialog.modal-register
				.modal-content
					.modal-header.no-border-header.text-center
						button.close(type='button', data-dismiss='modal', aria-label='Close')
							span(aria-hidden='true') ×
						h6.text-muted BIR Permit
						h3.modal-title.text-center Proof of BIR Permit
					.modal-body
						.row
							.col-md-12#birModalBody
		#landTitleModal.modal.fade(tabindex='-1', role='dialog', aria-hidden='false')
			.modal-dialog.modal-register
				.modal-content
					.modal-header.no-border-header.text-center
						button.close(type='button', data-dismiss='modal', aria-label='Close')
							span(aria-hidden='true') ×
						h6.text-muted Land Title
						h3.modal-title.text-center Proof of Ownership of Land
					.modal-body
						.row
							.col-md-12#landTitleModalBody
		#paymentModal.modal.fade(tabindex='-1', role='dialog', aria-hidden='false')
			.modal-dialog.modal-register
				.modal-content
					.modal-header.no-border-header.text-center
						button.close(type='button', data-dismiss='modal', aria-label='Close')
							span(aria-hidden='true') ×
						h6.text-muted Land Title
						h3.modal-title.text-center Proof of Ownership of Land
					.modal-body
						.row
							.col-md-12#paymentModalBody
								#accordion.panel-group
								// end acordeon
		form#reloadPage(method='GET' action='/admin/index')
		// Core JS Files. Extra: TouchPunch for touch library inside jquery-ui.min.js
		script(src='/paperDashboard/js/jquery-3.1.1.min.js', type='text/javascript')
		script(src='/paperDashboard/js/jquery-ui.min.js', type='text/javascript')
		script(src='/paperDashboard/js/perfect-scrollbar.min.js', type='text/javascript')
		script(src='/paperDashboard/js/bootstrap.min.js', type='text/javascript')
		// Switch and Tags Input Plugins
		script(src='/paperDashboard/js/bootstrap-switch-tags.js')
		// DataTables
		script(src='/paperDashboard/js/jquery.datatables.js')
		// Notifications Plugin
		script(src='/paperDashboard/js/bootstrap-notify.js')
		// Paper Dashboard PRO Core javascript and methods for Demo purpose
		script(src='/paperDashboard/js/paper-dashboard23cd.js?v=1.2.1')
		// Sharrre Library
		script(src='/paperDashboard/js/jquery.sharrre.js')
		// Paper Dashboard PRO DEMO methods, don't include it in your project!
		script(src='/paperDashboard/js/demo.js')
		script(type='text/javascript').
			$(document).ready(function() {
				$('#datatables').DataTable({
					"pagingType": "full_numbers",
					"lengthMenu": [[10, 25, 50, -1], [10, 25, 50, "All"]],
					responsive: true,
					language: {
					search: "_INPUT_",
						searchPlaceholder: "Search records",
					}
				});

				$('.viewId').click(function(){
					$.post('/admin/queryId', {id: $(this).val()})
					.done(data =>{
						$('#idModalBody').append(`<img src='${data.strValidID}' style='width: 500px;height:500px'/>`);
						$('#idModal').modal('show');
					});
				});

				$('.viewBir').click(function (){
					$.post('/admin/queryBir', {id: $(this).val()})
					.done(data =>{
						$('#birModalBody').append(`<img src='${data.strBIRPermit}' style='width: 500px;height:500px'/>`);
						$('#birModal').modal('show');
					});
				});	

				$('.viewLandTitle').click(function (){
					$.post('/admin/queryBir', {id: $(this).val()})
					.done(data =>{
						$('#landTitleModalBody').append(`<img src='${data.strLandTitle}' style='width: 500px;height:500px'/>`);
						$('#landTitleModal').modal('show');
					});
				});

				$('.viewPayment').click(function (){
					$.post('/admin/querypayments', {id: $(this).val()})
					.done(data =>{
						for(var z=0; z<data.length;z++){
							$('#accordion').append(`<div class="panel panel-border panel-default"><a data-toggle="collapse" href="#collapse${z}">
								<div class="panel-heading">
								<h4 class="panel-title">Payment Slip #${data[z].intAccountPaymentID}<i class="ti-angle-down"></i></h4>
								</div></a>
							<div id="collapse${z}" class="panel-collapse collapse">
								<div class="panel-body"><img src='${data[z].strDepositSlip}' style='width: 100%;height:100%'/>
									<button type='button' value='${data[z].intAccountPaymentID}' class='btn btn-success btn-rounded btn-sm verifyButton'>Verify</button>
									<button type='button' value='${data[z].intAccountPaymentID}' class='btn btn-danger btn-rounded btn-sm rejectButton'>Reject</button>
								</div>
							</div>
							</div>`);
						}
						$('.verifyButton').click(function(){
							$.post('/admin/verifypayment' ,{id:$(this).val()})
							.done(data =>{
								$('#accept'+data.strLandlordID).trigger('click')
							});
						});
						$('.rejectButton').click(function(){
							$.post('/admin/rejectpayment', {id:$(this).val()})
							.done(function(data){
								$('#reloadPage').submit();
							});
						});
						$('#paymentModal').modal('show');
					});
				});	

				$('.acceptLandlord').click(function(){
					$.post('/admin/verifylandlord', {id: $(this).val()})
					.done(function (data){
						$('#reloadPage').submit();
					});
				});

				$('.rejectLandlord').click(function(){
					$.post('/admin/rejectlandlord', {id: $(this).val()})
					.done(function (data){
						$('#reloadPage').submit();
					});
				});

				$('#idModal').on('hidden.bs.modal', function(){
					$('#idModalBody').empty();
				});
				$('#birModal').on('hidden.bs.modal', function(){
					$('#birModalBody').empty();
				});
				$('#landTitleModal').on('hidden.bs.modal', function(){
					$('#landTitleModalBody').empty();
				});
				$('#paymentModal').on('hidden.bs.modal', function(){
					$('#accordion').empty();
				});

			});